<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
        <meta charset="utf-8"/>
	    <title>wolf.cpp</title>
	    <link href="../../third-party/google-code-prettify/prettify-CppCoverage.css" type="text/css" rel="stylesheet" />
	    <script type="text/javascript" src="../../third-party/google-code-prettify/prettify.js"></script>
	</head>
    <body onload="prettyPrint()">
        <h4></h4>
        <pre class="prettyprint lang-cpp linenums">
ï»¿#include "wolf.hpp"

#ifdef WOLF_SYSTEM_MIMALLOC

#include &lt;DISABLE_ANALYSIS_BEGIN&gt;
#include &lt;mimalloc-new-delete.h&gt;
#include &lt;DISABLE_ANALYSIS_END&gt;

#endif

#if defined(WOLF_SYSTEM_STACKTRACE) &amp;&amp; !defined(WOLF_TESTS)

#include &lt;csignal&gt;
#include &lt;filesystem&gt;
#include &lt;fstream&gt;
#include &lt;sstream&gt;

static void w_signal_handler(int p_signum)
{
    auto _path = wolf::system::w_current_process_dir();
    _path = _path.append("wolf.dump");

    std::ignore = signal(p_signum, nullptr);

    std::stringstream _traces;

#ifdef __clang__
#pragma unroll
#endif // __clang__
    for (const auto&amp; trace : boost::stacktrace::stacktrace())
    {
        _traces &lt;&lt; "name: " &lt;&lt; trace.name() &lt;&lt; 
            " source_file: " &lt;&lt; trace.source_file() &lt;&lt; 
            "(" &lt;&lt; std::to_string(trace.source_line()) &lt;&lt; ")\r\n";
    }

    std::fstream _file;
    _file.open(_path.string(), std::ios_base::out, std::ios_base::_Default_open_prot);
    if (_file.is_open())
    {
        _file &lt;&lt; _traces.str();
        _file.close();
    }

    std::ignore = raise(SIGABRT);
}

#endif

std::string wolf::w_init()
<span style = "background-color:#dfd">{</span>
#if defined(WOLF_SYSTEM_STACKTRACE) &amp;&amp; !defined(WOLF_TESTS)
    std::ignore = signal(SIGSEGV, &amp;w_signal_handler);
    std::ignore = signal(SIGABRT, &amp;w_signal_handler);
#endif

    // Making incompatible API changes
<span style = "background-color:#dfd">    constexpr auto WOLF_MAJOR_VERSION = 3;</span>
    // Adding functionality in a backwards - compatible manner
<span style = "background-color:#dfd">    constexpr auto WOLF_MINOR_VERSION = 0;</span>
    // bug fixes
<span style = "background-color:#dfd">    constexpr auto WOLF_PATCH_VERSION = 0;</span>
    // for debugging
<span style = "background-color:#dfd">    constexpr auto WOLF_DEBUG_VERSION = 0;</span>

#ifdef __clang__
    int _size = std::snprintf( nullptr, 0, "v{%d}.{%d}.{%d}.{%d}",
        WOLF_MAJOR_VERSION, WOLF_MINOR_VERSION, WOLF_PATCH_VERSION, WOLF_DEBUG_VERSION);
		
    std::string _version(_size + 1, '\0');
	
    sprintf(&amp;_version[0],
        "v{%d}.{%d}.{%d}.{%d}",
        WOLF_MAJOR_VERSION, WOLF_MINOR_VERSION, WOLF_PATCH_VERSION, WOLF_DEBUG_VERSION);
#else
<span style = "background-color:#dfd">    auto _version = std::format(</span>
        "v{}.{}.{}.{}",
        WOLF_MAJOR_VERSION, WOLF_MINOR_VERSION, WOLF_PATCH_VERSION, WOLF_DEBUG_VERSION);
#endif
<span style = "background-color:#dfd">    return _version;
}</span></pre>
        <hr />
        <table width="100%">
            <thead>
                <tr>
                    <th align="center">
                        <small>Generated by</small>
                        <a href="https://github.com/OpenCppCoverage/OpenCppCoverage/releases">
                            <strong>OpenCppCoverage (Version: 0.9.9.0)</strong>
                        </a>
                    </th>
                </tr>
            </thead>
        </table>
    </body>
</html>
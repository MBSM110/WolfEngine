<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
        <meta charset="utf-8"/>
	    <title>w_rist.hpp</title>
	    <link href="../../third-party/google-code-prettify/prettify-CppCoverage.css" type="text/css" rel="stylesheet" />
	    <script type="text/javascript" src="../../third-party/google-code-prettify/prettify.js"></script>
	</head>
    <body onload="prettyPrint()">
        <h4></h4>
        <pre class="prettyprint lang-cpp linenums">
/*
    Project: Wolf Engine. Copyright © 2014-2022 Pooya Eimandar
    https://github.com/WolfEngine/WolfEngine
*/

#pragma once

#ifdef WOLF_STREAM_RIST

#include &lt;wolf.hpp&gt;
#include "w_rist_data_block.hpp"

namespace wolf::stream::rist {
class w_rist {
public:
  /*
   * constructor of the rist stream
   * @param p_mode, the context mode
   * @param p_profile, the rist profile
   * @param p_loss_percentage, the loss percentage of rist stream
   * @param p_log_level, the log level
   */
  W_API w_rist(_In_ rist_ctx_mode p_mode, _In_ rist_profile p_profile,
               _In_ uint16_t p_loss_percentage,
               _In_ rist_log_level p_log_level) noexcept;

  // move constructor.
<span style = "background-color:#fdd">  W_API w_rist(w_rist &amp;&amp;p_other) noexcept = default;</span>
  // move assignment operator.
<span style = "background-color:#fdd">  W_API w_rist &amp;operator=(w_rist &amp;&amp;p_other) noexcept = default;</span>

  // destructor
  W_API virtual ~w_rist();

  /*
   * initialize ris stream
   * @returns result
   */
  W_API boost::leaf::result&lt;int&gt; init();

  /**
   * connect or bind to the url
   * @param p_endpoint, the destination endpoint of rist stream
   */
  W_API
  boost::leaf::result&lt;int&gt; connect(_In_ std::string_view p_endpoint);

  /**
   * write a data block to the rist stream
   * @param p_block, the data block
   * @returns the number of written bytes with result
   */
  W_API boost::leaf::result&lt;size_t&gt; send(_In_ const w_rist_data_block &amp;p_block);

  /**
   * set data to rist data block
   * @param p_block, the data block
   * @param p_timeout, read timeout in milliseconds
   * @returns the number of read bytes with result
   */
  W_API boost::leaf::result&lt;size_t&gt; receive(_Inout_ w_rist_data_block &amp;p_block,
                                            _In_ int p_timeout_ms);

  // this callback will be called on log
  std::function&lt;void(_In_ rist_log_level /*p_log_level*/,
                     _In_ std::string_view /*p_msg*/)&gt;
      on_log_callback;

  // this signal will be called on auth connection
  std::function&lt;void(
      _In_z_ std::string_view /*p_conn_ip*/, _In_ uint16_t /*p_conn_port*/,
      _In_z_ std::string_view /*p_local_ip*/, _In_ uint16_t /*p_local_port*/)&gt;
      on_auth_connected_callback;

  // this signal will be called after disconnect
  std::function&lt;void()&gt; on_auth_disconnected_callback;

  // this signal will be called on receiving data
  std::function&lt;void(_In_ const w_rist_data_block&amp;)&gt; on_receiver_data_callback;

private:
  w_rist(const w_rist &amp;) = delete;
  w_rist &amp;operator=(const w_rist &amp;) = delete;
  void _release_log();

  rist_ctx_mode _mode;
  rist_profile _profile;
  uint16_t _loss_percentage;
  rist_log_level _log_level;
  rist_logging_settings *_log;
  rist_ctx *_ctx;
  rist_peer *_peer;
};
} // namespace wolf::stream::rist

#endif

</pre>
        <hr />
        <table width="100%">
            <thead>
                <tr>
                    <th align="center">
                        <small>Generated by</small>
                        <a href="https://github.com/OpenCppCoverage/OpenCppCoverage/releases">
                            <strong>OpenCppCoverage (Version: 0.9.9.0)</strong>
                        </a>
                    </th>
                </tr>
            </thead>
        </table>
    </body>
</html>